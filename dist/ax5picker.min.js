!function(i,t){var e=ax5.util,n=function(){var i,n=this;t&&t.call(this),this.activePicker=null,this.config={clickEventName:"click",theme:"default",width:300,title:"",lang:{ok:"ok",cancel:"cancel"},animateTime:250},this.config.btns={ok:{label:this.config.lang.ok,theme:this.config.theme}},i=this.config,i.id="ax5-picker-"+ax5.getGuid(),this.init=function(){},this.open=function(t,e){return this.activePicker?(console.log(ax5.info.getError("ax5picker","501","open")),this):(n.pickerConfig={},jQuery.extend(!0,n.pickerConfig,i),jQuery.extend(!0,n.pickerConfig,t),t=n.pickerConfig,this._open(t,e),this)},this.getContent=function(t,n){var s=[];return s.push('<div id="'+t+'" data-ax5-ui="picker" class="ax5-ui-picker '+n.theme+'">'),s.push('<div class="ax-picker-heading">'),s.push(n.title||i.title||""),s.push("</div>"),s.push('<div class="ax-picker-body">'),s.push('<div class="ax-picker-msg">'),s.push((n.msg||i.msg||"").replace(/\n/g,"<br/>")),s.push("</div>"),n.input&&(s.push('<div class="ax-picker-prompt">'),e.each(n.input,function(i,t){s.push('<div class="form-group">'),this.label&&s.push("    <label>"+this.label.replace(/\n/g,"<br/>")+"</label>"),s.push('    <input type="'+(this.type||"text")+'" placeholder="'+(this.placeholder||"")+' " class="form-control '+(this.theme||"")+'" data-ax-picker-prompt="'+i+'" style="width:100%;" value="'+(this.value||"")+'" />'),this.help&&s.push('    <p class="help-block">'+this.help.replace(/\n/g,"<br/>")+"</p>"),s.push("</div>")}),s.push("</div>")),s.push('<div class="ax-picker-buttons">'),s.push('<div class="ax-button-wrap">'),e.each(n.btns,function(i,t){s.push('<button type="button" data-ax-picker-btn="'+i+'" class="btn btn-'+(this.theme||"default")+'">'+this.label+"</button>")}),s.push("</div>"),s.push("</div>"),s.push("</div>"),s.push("</div>"),s.join("")},this._open=function(t,e){var n,s={};if(t.id=t.id||i.id,box={width:t.width},jQuery(document.body).append(this.getContent(t.id,t)),this.activePicker=jQuery("#"+t.id),this.activePicker.css({width:box.width}),t.height=box.height=this.activePicker.height(),"undefined"==typeof t.position||"center"===t.position){var a=window.innerWidth,c=window.innerHeight;s.top=c/2-box.height/2,s.left=a/2-box.width/2}else s.left=t.position.left||0,s.top=t.position.top||0;return this.activePicker.css(s),this.activePicker.find("[data-ax-picker-btn]").on(i.clickEventName,function(i){this.btnOnClick(i||window.event,t,e)}.bind(this)).get(0).focus(),jQuery(window).bind("keydown.ax-picker",function(i){this.onKeyup(i||window.event,t,e)}.bind(this)),jQuery(window).bind("resize.ax-picker",function(i){this.align(i||window.event)}.bind(this)),t&&t.onStateChanged&&(n={state:"open"},t.onStateChanged.call(n,n)),this},this.align=function(i){if(!this.activePicker)return this;var t=n.pickerConfig,e={width:t.width,height:t.height};return"undefined"==typeof t.position||"center"===t.position?(e.top=window.innerHeight/2-e.height/2,e.left=window.innerWidth/2-e.width/2):(e.left=t.position.left||0,e.top=t.position.top||0),this.activePicker.css(e),this},this.btnOnClick=function(i,t,n,s,a){if(i.srcElement&&(i.target=i.srcElement),s=e.findParentNode(i.target,function(i){return i.getAttribute("data-ax-picker-btn")?!0:void 0})){a=s.getAttribute("data-ax-picker-btn");var c={key:a,value:t.btns[a],pickerId:t.id,btnTarget:s};if("prompt"===t.pickerType){var o=null;for(var r in t.input)if(c[r]=this.activePicker.find("[data-ax-picker-prompt="+r+"]").val(),""==c[r]||null==c[r]){o=r;break}}if(t.btns[a].onClick)t.btns[a].onClick.call(c,a);else if("alert"===t.pickerType)n&&n.call(c,a),this.close();else if("confirm"===t.pickerType)n&&n.call(c,a),this.close();else if("prompt"===t.pickerType){if("ok"===a&&o)return this.activePicker.find('[data-ax-picker-prompt="'+o+'"]').get(0).focus(),!1;n&&n.call(c,a),this.close()}}},this.onKeyup=function(i,t,e,n,s){if(i.keyCode==ax5.info.eventKeys.ESC&&this.close(),"prompt"===t.pickerType&&i.keyCode==ax5.info.eventKeys.RETURN){var a={key:s,value:t.btns[s],pickerId:t.id,btnTarget:n},c=null;for(var o in t.input)if(a[o]=this.activePicker.find("[data-ax-picker-prompt="+o+"]").val(),""==a[o]||null==a[o]){c=o;break}if(c)return!1;e&&e.call(a,s),this.close()}},this.close=function(t,e){return this.activePicker&&(t=n.pickerConfig,this.activePicker.addClass("destroy"),jQuery(window).unbind("keydown.ax-picker"),jQuery(window).unbind("resize.ax-picker"),setTimeout(function(){this.activePicker.remove(),this.activePicker=null,t&&t.onStateChanged&&(e={state:"close"},t.onStateChanged.call(e,e))}.bind(this),i.animateTime)),this},this.main=function(){arguments&&e.isObject(arguments[0])&&this.setConfig(arguments[0])}.apply(this,arguments)};i.picker=function(){return e.isFunction(t)&&(n.prototype=new t),n}()}(ax5.ui,ax5.ui.root);